var cookieManager={get:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return!!t&&decodeURIComponent(t[1])},set:function(e,t,a){var n=(a=a||{}).expires;if("number"==typeof n&&n){var r=new Date;r.setTime(r.getTime()+1e3*n),n=a.expires=r}n&&n.toUTCString&&(a.expires=n.toUTCString());var i=e+"="+(t=encodeURIComponent(t));for(var o in a){i+="; "+o;var s=a[o];!0!==s&&(i+="="+s)}document.cookie=i},delete:function(e){this.set(e,"",{expires:-1})}},startTitle=document.title,startDescription=document.description,h1=document.getElementsByTagName("h1")[0].text,isMob=window.innerWidth<=600;function suggestions(){var e="",t="594a4e1d0a69de473f8b4569",a=5;function n(e){var t=e.typeShort+". "+e.name;if(e.parents)for(var a=e.parents.length-1;a>-1;a--){var n=e.parents[a];n.name&&"city"==n.contentType&&(t=n.name+", "+t)}return t}e||setTimeout(function(){$.ajax({type:"GET",crossDomain:!0,dataType:"jsonp",url:"https://kladr-api.ru/api.php",data:{token:t,limit:1,contentType:"city",query:City.name},success:function(r){e=r.result[0],$("#from").kladr({oneString:!0,token:t,limit:a,parentId:e.id,parentType:e.contentType,regionId:e.id,withParent:!0,oneString:!0,type:"street",labelFormat:function(e){return n(e)},valueFormat:function(e){return n(e)}}),$("#to").kladr({oneString:!0,token:t,limit:a,parentId:e.id,parentType:e.contentType,regionId:e.id,withParent:!0,oneString:!0,type:"street",labelFormat:function(e){return n(e)},valueFormat:function(e){return n(e)}}),$("#address").kladr({oneString:!0,token:t,limit:a,parentId:e.id,type:"street",parentType:e.contentType,regionId:e.id,withParent:!0,oneString:!0,labelFormat:function(e){return n(e)},valueFormat:function(e){return n(e)}})}})},2e3)}function ucall(e){$.getJSON("//ulogin.ru/token.php?host="+encodeURIComponent(location.toString())+"&token="+e+"&callback=?",function(e){(e=$.parseJSON(e.toString())).error?userInterface.showMessage("Ошибка авторизации"):authModule.socialAuth(e,!0)})}var CHECKED=1,NO_CHECKED=0,distance=[500,1e3,2e3,3e3],paramsManager=function(){document.getElementsByTagName("h1")[0].text;var e={};return e.page=NO_CHECKED,e.worktime=NO_CHECKED,e.workdays=NO_CHECKED,e.time=NO_CHECKED,e.is24x7=NO_CHECKED,e.street=NO_CHECKED,e.district=NO_CHECKED,e.site=NO_CHECKED,e.review=NO_CHECKED,e.photo=NO_CHECKED,e.rubric=NO_CHECKED,e.tag=NO_CHECKED,e.near=NO_CHECKED,e.by_title=NO_CHECKED,e.by_rating=NO_CHECKED,e.by_distance=NO_CHECKED,e.filial=NO_CHECKED,e.card=NO_CHECKED,e.distance=distance[1],e.attributes={},e.center,e.zoom=12,{clear:function(t){e[t]=NO_CHECKED,userInterface.setFilters()},setFromUrl:function(){for(var t,a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<a.length;n++)"page"!=(t=a[n].split("="))[0]?paramsManager.set(t[0],t[1]):e.page=t[1]},setDefault:function(){for(var t in e)paramsManager.set(t,NO_CHECKED),paramsManager.clearUrl()},toggle:function(e){paramsManager.get(e)==NO_CHECKED?paramsManager.set(e,CHECKED):paramsManager.set(e,NO_CHECKED)},getAll:function(){return e},getTextQuery:function(){return $(".map__search-input-name").val()},setPage:function(t){e.page=t,paramsManager.setUrl("page")},toggleDay:function(t){e.workdays=t},set:function(t,a){return paramsManager.get(t)!=a&&(paramsManager.setPage(NO_CHECKED),e[t]=a)},toggleAtribute:function(t){e.attributes[t]?delete e.attributes[t]:e.attributes[t]=t},get:function(t){return e[t]},getMapCenter:function(){var t=e.center;return"string"==typeof t?t?t.split(","):"":t},setUrl:function(e){var t=[location.protocol,"//",location.host,location.pathname].join(""),a=document.location.search,n=paramsManager.get(e)!=NO_CHECKED?e+"="+paramsManager.get(e):"",r="?"+n;if(a){var i=new RegExp("([?&])"+e+"[^&]*");r=null!==a.match(i)?a.replace(i,"$1"+n):""!=n?a+"&"+n:a}var o=t+(r=r.replace(/&$/,""));o=o.replace(/\?$/,""),window.history.replaceState({},"",o)},clearUrl:function(){var e=[location.protocol,"//",location.host,location.pathname].join("");window.history.pushState("","",e)}}}();const KEY_ENTER=13,KEY_UP=38,KEY_DOWN=40,KEY_ESC=27;var userInterface={searchHistorySelect:function(e){var t=$("#search-autocomplete a").index($(".active")),a=$("#search-autocomplete a");if(a.removeClass("active"),27==e.keyCode&&($(".search__history ul").remove(),$("#search-form input").blur()),40==e.keyCode&&(t>=a.length-1&&(t-=a.length),t++,a.eq(t).addClass("active")),38==e.keyCode&&(--t<0&&(t+=a.length),a.eq(t).addClass("active")),13==e.keyCode&&t>=0){var n=a.eq(t).attr("href");document.location.href=n,$("#search-autocomplete").empty(),e.preventDefault()}},liveSearchResult:function(e){$("#search-autocomplete").html(e)},cardBlockRoll:function(){var e=$(".js-map__info-card"),t=e.find(".js-map__info-card-block-worktime"),a=e.find(".js-map__info-card-block-phone"),n=e.find(".map__info-card-trigger--close"),r=e.find(".map__info-card-trigger--roll, .on-map"),i=$(".map__info-header-trigger"),o=$(".js-map__info"),s=o.find(".map__info-header"),c=o.find(".map__info-content"),l=o.find(".map__info-card-icon"),p=o.find(".map__info-icon");t.click(function(){$(".contacts__info-wortime").slideToggle()}),a.click(function(){$(".map__info-card-block-phone").toggleClass("hide"),$(".map__info-card-block-notice").toggleClass("hide")}),n.click(function(){$(".frame__mover").remove(),e.hide(),i.show(),userInterface.setTitle(startTitle),paramsManager.clear("card"),paramsManager.setUrl("card")}),r.click(function(){$(".frame__mover").hide(),e.hide(),o.addClass("rolled"),s.hide(),c.hide(),l.show(),p.show()}),l.click(function(){o.removeClass("rolled"),$(".frame__mover").show(),s.show(),c.show(),l.hide(),p.hide(),e.show()}),e.find(".map__info-card-title a, .map__info-card-review-link--more").click(function(){userInterface.saveActiveFirm(localStorage.getItem("activeFirm"))})},cardHide:function(){$(".js-map__info-card, .frame__mover").hide()},slideCard:function(){var e=$(".frame__mover"),t=$(".js-map__info-card");e.hasClass("left")?e.html("&#10096;"):e.html("&#10097;"),t.toggleClass("left"),e.toggleClass("left")},setFilters:function(){var e=paramsManager.getAll();for(var t in e){var a=$("[data-type="+t+"]");paramsManager.get(t)==NO_CHECKED?(a.removeClass("active"),a.removeAttr("checked")):a.addClass("active")}userInterface.distanceButtons(),ajaxManager.setFilters()},setMyAddress:function(e){e&&$("#address").val(e)},setCounters:function(){$(".company-count span").each(function(){$(this).prop("Counter",0).animate({Counter:FirmList.length},{duration:100,easing:"swing",step:function(e){$(this).text(Math.ceil(e))}})})},refreshSelectFilters:function(){if(window.streets&&!paramsManager.get("street")){var e='<option value="0">Улица</option>';for(r=0;r<window.streets.length;++r){var t=window.streets[r];e+='<option value="'+t.url+'">'+t.name+"</option>"}$('select[data-type="street"]').html(e),jQuery('select[data-type="street"]').styler("destroy"),jQuery('select[data-type="street"]').styler()}if(window.districts&&!paramsManager.get("district")){for(e='<option value="0">Район</option>',r=0;r<window.districts.length;++r){var a=window.districts[r];e+='<option value="'+a.url+'">'+a.name+"</option>"}$('select[data-type="district"]').html(e),jQuery('select[data-type="district"]').styler("destroy"),jQuery('select[data-type="district"]').styler()}if(window.rubric_list&&!paramsManager.get("rubric")){for(e='<option value="0">Категория</option>',r=0;r<window.rubric_list.length;++r){var n=window.rubric_list[r];e+='<option value="'+n.id+'">'+n.name+"</option>"}$('select[data-type="rubric"]').html(e),jQuery('select[data-type="rubric"]').styler("destroy"),jQuery('select[data-type="rubric"]').styler()}if(window.tag_list&&!paramsManager.get("tag")){var r;for(e='<option value="0">Ключевое слово</option>',r=0;r<window.tag_list.length;++r){var i=window.tag_list[r];e+='<option value="'+i.id+'">'+i.name+"</option>"}$('select[data-type="tag"]').html(e),jQuery('select[data-type="tag"]').styler("destroy"),jQuery('select[data-type="tag"]').styler()}},setTitle:function(e){document.title=e},setH1:function(e){$("h1").text(e)},setDescription:function(e){document.querySelector('meta[name="description"]').setAttribute("content",e)},showMessage:function(e){e=$('<div class="popup-message">'+e+"</div>"),$(".l-page-container").append(e),e.slideDown(),setTimeout(function(){e.remove()},2e3)},distanceButtons:function(){$(".range").hide(),paramsManager.get("near")==CHECKED&&$(".range").show()},saveActiveFirm:function(e){localStorage.setItem("activeFirm",e),localStorage.setItem("activeFirmLink",document.location.href),localStorage.setItem("activeFirmExpire",+new Date+18e4)},onclickMapAny:function(){jQuery(window).width()<800&&jQuery(".on-map").click()}};$(document).ready(function(){var e={city:City.url,street:0,district:0,near:0,worktime:0,lat:0,lon:0,by_rating:0,by_title:0},t=$(".front-search-page").data("query"),a=new Date((new Date).getTime()+432e5),n=new Object;function r(){$(".firm_list").css("opacity","0.5"),$.ajax({url:"/search/front-ajax/"+t,type:"GET",data:e,success:function(e){$(".firm_list").html(e),$(".firm_list").css("opacity","1")},error:function(){return $(".firm_list").css("opacity","1"),!1}})}n.path="/",n.expires=a,$(".front-search-page .filter-select--js").on("change",function(){var t=$(this).val(),a=$(this).data("type");e[a]=t,r()}),$(".front-search-page .filter--js").on("click",function(){var t=$(this).val(),a=$(this).data("type");$(this).toggleClass("btn_active"),e[a]^=t,"near"==a&&e[a]?ymaps.geolocation.get({provider:"auto",mapStateAutoApply:!0}).then(function(t){var a=t.geoObjects;e.lat=a.position[0],e.lon=a.position[1],cookieManager.set("lat",a.position[0],n),cookieManager.set("lon",a.position[1],n),r()}):r()})});